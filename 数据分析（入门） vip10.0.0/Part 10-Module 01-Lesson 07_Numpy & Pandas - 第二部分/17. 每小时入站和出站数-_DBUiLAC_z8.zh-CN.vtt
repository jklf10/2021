WEBVTT
Kind: captions
Language: zh-CN

00:00:00.260 --> 00:00:03.220
我要从之前写的函数入手

00:00:03.220 --> 00:00:06.950
因为它正是计算单组每小时出入站人数的代码

00:00:06.950 --> 00:00:10.330
这一次 我把函数命名为 hourly_for_group

00:00:10.330 --> 00:00:14.750
首先 我需要按单位对 ridership_df 进行分组 

00:00:14.750 --> 00:00:17.090
与往常一样 我得到了 DataFrameGroupBy 对象

00:00:18.280 --> 00:00:22.660
这时候 apply(hourly_for_group) 函数的做法看似合理

00:00:22.660 --> 00:00:25.980
但如果我这么做 就会得到类型错误的信息

00:00:25.980 --> 00:00:28.500
信息显示 不支持字符串和字符串的

00:00:28.500 --> 00:00:30.330
减号运算类型

00:00:30.330 --> 00:00:33.680
出现此类错误的原因是 Pandas 试图

00:00:33.680 --> 00:00:37.240
在 DataFrame 的每一列上调用 hourly_for_group 函数

00:00:37.240 --> 00:00:38.840
包括单位列和时间列

00:00:38.840 --> 00:00:42.080
由于这些列包含字符串 因此 该函数无法对其进行运算

00:00:42.080 --> 00:00:44.500
这是字符串之间无法相减

00:00:44.500 --> 00:00:47.210
为了解决这一问题 我需要在调用该函数前

00:00:47.210 --> 00:00:50.540
只选中出入站列

00:00:50.540 --> 00:00:52.950
这样一以来 函数就可以正常运算了

00:00:54.040 --> 00:00:57.310
这一次 结果中有两行 NaN 分别对应两个车站

00:00:57.310 --> 00:00:59.570
这是因为 每个车站的第一行

00:00:59.570 --> 00:01:01.640
都没有可供比较的前一行

