WEBVTT
Kind: captions
Language: zh-CN

00:00:00.190 --> 00:00:03.130
我首先观察一下两个 DataFrame 中

00:00:03.130 --> 00:00:04.530
我需要合并的前三行

00:00:04.530 --> 00:00:07.980
第一步要做的是决定 on 的关键词是什么

00:00:07.980 --> 00:00:10.930
也就是怎样匹配两个 DataFrame 中的行

00:00:12.080 --> 00:00:16.540
看起来 我应该按照日期和时间

00:00:16.540 --> 00:00:19.120
以及纬度和经度

00:00:19.120 --> 00:00:22.060
所以 我要调用 subway_df.merge(weather_df)

00:00:22.060 --> 00:00:25.510
那么 on 关键词就是这四个域

00:00:25.510 --> 00:00:29.360
我还需要决定 how 应设为 inner、outer、left 还是 right

00:00:29.360 --> 00:00:32.830
我选择 inner 因为我只需要两个表都含有的行

00:00:33.920 --> 00:00:36.910
输出结果是含有两个表所有列的 DataFrame

00:00:36.910 --> 00:00:40.380
例如 出入站列是地铁数据中的

00:00:40.380 --> 00:00:43.340
而雾和气压两列是天气数据中的

00:00:43.340 --> 00:00:47.040
它们都按照日期、时间、纬度和经度进行了匹配

00:00:47.040 --> 00:00:49.880
在这里 我想合并的这四列在两个 DataFrame 中的名称相同

00:00:49.880 --> 00:00:52.600
这使合并过程较简单

00:00:52.600 --> 00:00:53.890
那如果名称不同怎么办？

00:00:55.000 --> 00:00:58.070
比如 如果地铁数据中的日期列叫做 DATEn

00:00:58.070 --> 00:01:02.490
而天气数据中的这一列叫做 date 那怎么办呢？

00:01:02.490 --> 00:01:05.740
在 Pandas 中 你可以确定 left_on 和 right_on 的值

00:01:05.740 --> 00:01:09.740
它们分别代表左侧表的列 

00:01:09.740 --> 00:01:11.950
和右侧表的列

00:01:11.950 --> 00:01:15.060
在 left_on 中 列名与之前相同

00:01:15.060 --> 00:01:18.210
在 right_on 中 其它的列名也不变

00:01:18.210 --> 00:01:19.730
只是日期列的名称有所不同

00:01:19.730 --> 00:01:21.860
这个代码会返回与之前相同的结果

